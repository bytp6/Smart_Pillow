<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>embARC: Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 50px;">
  <td id="projectlogo"><img alt="Logo" src="embARC_Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectnumber">2016.05</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_library.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sect_lib_clib">C Library Support</a><ul><li class="level2"><a href="#sect_lib_clib_newlibc">ARC GNU Newlib</a></li>
<li class="level2"><a href="#sect_lib_clib_metawareclib">MetaWare C Run-Time Library</a></li>
</ul>
</li>
<li class="level1"><a href="#sect_lib_secureshield">SecureShield</a><ul><li class="level2"><a href="#sect_lib_secureshield_overview">Overview</a></li>
<li class="level2"><a href="#sect_lib_secureshield_terminology">Terminology</a><ul><li class="level3"><a href="#subsect_lib_secureshield_terminology_container">Container</a></li>
<li class="level3"><a href="#subsect_lib_secureshield_terminology_access_control">Access Control</a></li>
<li class="level3"><a href="#subsect_lib_secureshield_terminology_ss_runtime">SecureShield Runtime</a></li>
</ul>
</li>
<li class="level2"><a href="#sect_lib_secureshield_application">SecureShield Application</a><ul><li class="level3"><a href="#subsect_lib_secureshield_application_feature_app">SecureShield Feature Example</a></li>
<li class="level3"><a href="#subsect_lib_secureshield_application_secret_app">SecureShield Secret Example</a></li>
<li class="level3"><a href="#subsect_lib_secureshield_application_tinydtls_client_app">SecureShield TinyDTLS Client Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sect_lib_clib"></a>
C Library Support</h1>
<p>Provide support for file-related APIs using FatFs, printf() support using a UART, and time-related APIs. For details, please refer to the source code library/clib. The C library support implemented in embARC is compatible with both the GNU toolchain for ARC Processors and the MetaWare Development Toolkit C library implementations (each included in their respective toolchain package). More information on each C library is included below. </p>
<h2><a class="anchor" id="sect_lib_clib_newlibc"></a>
ARC GNU Newlib</h2>
<p><a href="https://sourceware.org/newlib/">Newlib</a> is a C standard library implementation intended for use on embedded systems. It is a conglomeration of several library parts, all under <a href="https://sourceware.org/newlib/COPYING.NEWLIB">free software licenses</a> that make them easily usable on embedded products.</p>
<p>It was created by Cygnus Support as part of building the first GNU cross-development toolchains. It is now maintained by Red Hat developers Jeff Johnston and Corinna Vinschen, and is used in most commercial and non-commercial GCC ports for non-Linux embedded systems.</p>
<h2><a class="anchor" id="sect_lib_clib_metawareclib"></a>
MetaWare C Run-Time Library</h2>
<p>The MetaWare C Run-Time Library is a collection of functions, macros, and type declarations organized into header files according to ANSI Standard C Library areas, such as mathematics and string handling. The MetaWare C Run-Time Library is an ANSI Standard C library with extensions. The macros, function names and parameters, and types are those dictated by the ANSI C Standard. The library conforms to the ANSI C Standard (ANSI document X3J11/90-014); the single-precision math functions conform to the ISO/ANSI C99 Standard. The library also provides additional functions not described in the ANSI C Standard.</p>
<h1><a class="anchor" id="sect_lib_secureshield"></a>
SecureShield</h1>
<h2><a class="anchor" id="sect_lib_secureshield_overview"></a>
Overview</h2>
<p>SecureShield enables the execution of applications in isolated, Trusted Execution Environments (TEE). Multiple, isolated environments can run on a single core. The Secureshield runtime is a microvisor implementation that provides the required isolation, enforced by processor privilege levels and the memory-protection unit (MPU). Depending on the level of trust for the application, each execution environment can be given or denied access to system resources like memory, memory-mapped I/O, CPU control registers, and APEX extension instructions and registers.</p>
<p> 
<div class="imagebox">
    <div style="width: 900px">
        <img src="pic/secureshield_overview.jpg" alt="SecureShield Overview"/>
        <p>SecureShield Overview</p>
    </div>
</div>
 <h2><a class="anchor" id="sect_lib_secureshield_terminology"></a>
Terminology</h2>
<h3><a class="anchor" id="subsect_lib_secureshield_terminology_container"></a>
Container</h3>
<p>A container defines a sandbox for an application. The container provides the trusted execution environment for application code. Containers are designed to be isolated from each other. Each container has its own space attributes, including the stack area (required), context area (optional), resources (peripherals, interrupt, auxiliary registers). A container context is the memory area that is used for the container itself; its type is defined in the container configuration.</p>
<p>The SecureShield runtime supports two types of containers: Secure containers and non-secure containers. </p><h4>Secure Containers</h4>
<p>Secure containers run in secure/kernel mode. They can access all resources in the system. Secure containers are trusted; bugs or malware in a secure container can compromise the system. Currently, the SecureShield runtime only supports one secure container. </p><h4>Non-Secure Containers</h4>
<p>Non-secure containers run in non-secure/user mode. Their access to system resources is limited. Non-secure containers are only allowed to access the resources allocated to them. If they attempt to access other resources, a violation exception is raised. </p><h4>Background Container</h4>
<p>A background container is a special non-secure container whose resources are shared to all the other containers. It has no context area, and its stack is the original application stack when SecureShield is not enabled.</p>
<p> 
<div class="imagebox">
    <div style="width: 900px">
        <img src="pic/secureshield_containers.jpg" alt="Containers in SecureShield"/>
        <p>Containers in SecureShield</p>
    </div>
</div>
 <h3><a class="anchor" id="subsect_lib_secureshield_terminology_access_control"></a>
Access Control</h3>
<p>The privileges that a container has to access the system are defined as Access Control (AC).</p>
<p>Each container has a table that defines its access rights to system resources, including memory, interrupts, and peripherals. This table is called the access-control table or access-control list.</p>
<p>Each item in this table or list is called an access-control item. An access control item has the type access control, and additional attributes that constitute a triple: {attribute1, attribute2, type|access}. The resources not described in the access-control table are controlled by background access control, which only allows secure/kernel mode to access system resources.</p>
<p>An access-control table example is shown below:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;static const CONTAINER_AC_ITEM g_container1_act[] = {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        {(void *)PERIPHERAL_ADDR_BASE, 0x10000, SECURESHIELD_ACDEF_UPERIPH},</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        {(void *)0, 0x500, SECURESHIELD_AC_AUX},</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        {default_interrupt_handler, INTNO_GPIO, SECURESHIELD_AC_IRQ},</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        {default_interrupt_handler, INTNO_UART1, SECURESHIELD_AC_IRQ},</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        {default_interrupt_handler, INTNO_I2C0, SECURESHIELD_AC_IRQ},</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        {default_interrupt_handler, INTNO_SPI_MASTER, SECURESHIELD_AC_IRQ},</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        {soft_interrupt1, SWI_INTNO1, SECURESHIELD_AC_IRQ},</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        {default_interrupt_handler, INTNO_TIMER0, SECURESHIELD_AC_IRQ},</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        {default_interrupt_handler, INTNO_TIMER1, SECURESHIELD_AC_IRQ},</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;};</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;typedef struct {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        uint8_t secret[128];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        uint8_t initialized;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;} TEST_CONTEXT;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;SECURESHIELD_CONTAINER_CONFIG(container1, g_container1_act, 1024, TEST_CONTEXT);</div>
</div><!-- fragment --><p>According to this access control table, container1 is allocated a peripheral area starting from PERIPHERAL_ADDR_BASE with a size of 0x10000 bytes, an auxiliary-register area starting from 0 with a size of 0x500, and seven interrupts.</p>
<p>Container1 also has a 1024-byte stack and a context type of <a class="el" href="struct_t_e_s_t___c_o_n_t_e_x_t.html">TEST_CONTEXT</a> with a size of <a class="el" href="struct_t_e_s_t___c_o_n_t_e_x_t.html">TEST_CONTEXT</a>.</p>
<p>The system resource type describes the kind of resource, such as interrupt, register, or memory. The access-control attribute describes how it is accessed: user mode, kernel mode, secure and normal. The definitions of system resource type and access-control attribute can be seen in secureshield_vmpu_exports.h.</p>
<h3><a class="anchor" id="subsect_lib_secureshield_terminology_ss_runtime"></a>
SecureShield Runtime</h3>
<p>The SecureShield runtime is a small background program that manages the containers. A container communicates with the SecureShield runtime through a monitor call.</p>
<h4>Monitor Calls</h4>
<p>In SecureShield, a monitor call is a trap call in assembly language but works like a normal function call. A monitor call is the only communication interface for a container to monitor to calls a service. The following SecureShield runtime services are provided:</p><ul>
<li>interrupt management; see secureshield_int_exports.h</li>
<li>auxiliary-register access and benchmark functions; see secureshield_sys_ops_exports.h</li>
</ul>
<h4>Container Calls</h4>
<p>Although containers are isolated from each other, a container can provide services to other containers through container calls. This function or service must be first registered in an access table. The background container has no interface.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;int tst_func2(int arg1, int arg2)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        return arg1+arg2;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;}</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;static const CONTAINER_AC_ITEM g_container1_act[] = {</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        {tst_func, 2, SECURESHIELD_AC_INTERFACE}</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;};</div>
</div><!-- fragment --><p>In the above code, container1 has one interface named tst_func2 with two arguments to provide services. If other containers want to call this service, the following container call should be called:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;ret = container_call(container1, tst_func2, 1, 2);</div>
</div><!-- fragment --><p>1 and 2 are arguments passed to tst_fun2, ret is the return value of tst_func.</p>
<h2><a class="anchor" id="sect_lib_secureshield_application"></a>
SecureShield Application</h2>
<p>There are several SecureShield application examples in embARC.</p><ul>
<li><a class="el" href="group___e_m_b_a_r_c___a_p_p___b_a_r_e_m_e_t_a_l___s_e_c_u_r_e_s_h_i_e_l_d___t_e_s_t___c_a_s_e.html">baremetal/secureshield/test_case</a> demonstrates and tests the features of SecureShield.</li>
<li><a class="el" href="group___e_m_b_a_r_c___a_p_p___b_a_r_e_m_e_t_a_l___s_e_c_u_r_e_s_h_i_e_l_d___s_e_c_r_e_t.html">baremetal/secureshield/secret</a> and its derived example <a class="el" href="group___e_m_b_a_r_c___a_p_p___b_a_r_e_m_e_t_a_l___s_e_c_u_r_e_s_h_i_e_l_d___s_e_c_r_e_t2.html">baremetal/secureshield/secret2</a> shows examples of a secret being protected by a password.</li>
<li><a class="el" href="group___e_m_b_a_r_c___a_p_p___c_o_n_t_i_k_i___s_e_c_u_r_e_s_h_i_e_l_d___d_t_l_s___c_l_i_e_n_t___i_p_v4.html">contiki/secureshield/dtls_client_ipv4</a> demonstrates how to integrate SecureShield in a full fledged application.</li>
</ul>
<h3><a class="anchor" id="subsect_lib_secureshield_application_feature_app"></a>
SecureShield Feature Example</h3>
<p>The test_case serves as a unit test of secureshield features. All features provided by secureshield are simply tested in this example.</p>
<h3><a class="anchor" id="subsect_lib_secureshield_application_secret_app"></a>
SecureShield Secret Example</h3>
<p>This example is designed to show how to protect data using secureshield.</p>
<p>As shown below, the secret is protected in container, user needs to input the right password to get the secret. Container2 is trusted by container1, and thus does not need the password to get the secret.</p>
<p>The secret example shows how to use container separation, container check and secure container, and how to define application specific linker script.</p>
<p> 
<div class="imagebox">
    <div style="width: 900px">
        <img src="pic/secureshield_secret.jpg" alt="SecureShield secret example"/>
        <p>SecureShield secret example</p>
    </div>
</div>
 <h3><a class="anchor" id="subsect_lib_secureshield_application_tinydtls_client_app"></a>
SecureShield TinyDTLS Client Example</h3>
<p>In IoT applications, communication between nodes is secured by TLS (for TCP) or DTLS (for UDP). For TLS and DTLS, the critical parts are keys, certification files, and TRNG. If these critical parts are compromised (read or written without permission), secure communication is at risk.</p>
<p> 
<div class="imagebox">
    <div style="width: 900px">
        <img src="pic/secureshield_tinydtls.jpg" alt="SecureShield tinydtls example"/>
        <p>SecureShield tinydtls example</p>
    </div>
</div>
 <p>This example is a SecureShield-protected secure communication demo, where the key and TRNG device (optional) required by the AES128_CCM protocol are located in container 1 and isolated with application in container 0. The container call is the only entry to access the key data. In the container call, a check is done to only allow the specific container and function to access the key data.</p>
<p>If malware tries to bypass the check in the container call and directly access the key data, an exception is raised. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jun 30 2016 23:55:42 for embARC by
    <a href="http://www.synopsys.com">
    <img class="footer" src="pic/snps_logo.png" alt="snps_logo"/></a>. All Rights Reserved. </li>
  </ul>
</div>
</body>
</html>
